#!/bin/bash -e

files=`find gencode/ -type f | sort`

if [[ $1 == check ]]; then
    echo Chekcing gencode hash...
    cat $files | sha256sum > /tmp/gencode.hash
    if ! diff /tmp/gencode.hash .gencode_hash.txt; then
        sha256sum $files
        false
    fi
    exit 0
fi

bin/gencode_java
bin/gencode_python gencode/python schema/*.json
bin/gencode_docs

cat $files | sha256sum > .gencode_hash.txt
