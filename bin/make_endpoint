#!/bin/bash -e

UDMI_ROOT=$(dirname $0)/..
cd $UDMI_ROOT

source etc/shell_common.sh

out_file=$1
project_id=$2
site_model=$3
registry_suffix=$4
device_id=$5
shift 5 || usage out_file project_id site_model registry_suffix device_id

echo out_file=$out_file
echo project_id=$project_id
echo site_model=$site_model
echo registry_suffix=$registry_suffix
echo device_id=$device_id

parse_project_id

cat <<EOF > $out_file
{
  "protocol": "mqtt",
  "client_id": "projects/$project_target/locations/$cloud_region/registries/$registry_prefix$registry_id$registry_suffix/devices/$device_id",
  "hostname": "$broker_hostname"
}
EOF
