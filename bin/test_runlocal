#!/bin/bash -e
#
# This doesn't actually run the local stuff, it's just used post-execution to validate results.
#

UDMI_ROOT=$(dirname $0)/..
cd $UDMI_ROOT

source etc/shell_common.sh

cat out/message_capture.log

echo Captured $(wc -l out/message_capture.log) messages.

deletes=$(find out/registries/ -name \*update_model.json | xargs jq .cloud.operation | fgrep DELETE | wc -l)
[[ $deletes == 2 ]] || fail Expected 2 delete operations, found $deletes

echo Done with successful runlocal validation.
