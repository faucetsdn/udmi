[**UDMI**](../../) / [**Docs**](../) / [**Specs**](./) / [Subblocks](#)

# Subblocks API

The _Subblocks API_ defines a high-level interface between UDMI core services and ancillary
applications. These messages are similar to those used for device communication, but are
Specifically segmented by designated _subblocks_ that partition functionality into atomic
chunks. Specifically, the subblock _state_/_config_ are a limited form of the overall
device _state_/_config_, and only expose the relevant pieces.

The basic mode of this interface is a "read only" subscription to a PubSub topic (normally
`udmi_target`) that then provides a complete view of updates as they flow through the system.
This level of visibility should be sufficient to completely mirror the
visible state of the system (barring issues like loss-of-message etc...).

Messages are typed by their _subType_ and _subFolder_ (named thusly because of legacy integrations).
The _subType_ field specifies generic message semantics, while the _subFolder_ specifies the
semantic interpretation.

## _subType_ attribute values

Seval main _subType_ values cover normal system operations. Other values not specified here should
be ignored if received. If the _subType_ field is missing then it should default to `event`.

* `event`: Streaming telemetry from the device, representing changes to metrics or other values
  that are nominally intended to be stored in a TSDB or similar.
  See [pointset event](../../tests/schemas/events_pointset/example.json)) as example. Messages
  with a defaulted `event` type represent raw telemetry from the device, while an explicit `event`
  type means the messages has been processed by the intermediate pipeline in some form.
* **state**: Device state for this subblock. Unlike a
  [comprehensive device state message](../../tests/schemas/state/example.json)
  this message contains information _only_ for a single subblock. Used for reporting any 'sticky'
  state from a device that has been processed and separated out by the UDMIS pipeline. A specical
  _subFolder_ of `update` indicates a complete state message and should generally be ignored by
  consuming applications.
* **config**: A confirmed device config update for this subblock. Unlike a
  [comprehensive device config message](../../tests/schemas/config/example.json)
  this message contains information _only_ for a single subblock. This message is injected after
  the config update has been applied to the device as an effective confirmation of an applied
  config change.
* **model**: Model-based description of this device(so does not correspond to any to/from device
  message). This message is generated by various tools (such as `registrar`) that manipulate the
  cloud-based provisioning and setup of the device. Generally, this is a live reflection of the
  device's `site_model` contents.

## _subFolder_ attribute values

The _subFolder_ attribute describes the semantic category for the message. There's many potential
values for this enum (and it can be easily extended), but there are some primary values commonly
of interest (and values not relevant to any given application should be ignored).

* [`system`](../messages/system.md): High level information about a device as an overall entity,
  independent of specific functional blocks.
* [`pointset`](../messages/pointset.md): Relating to point (value reading) telemetry and values.
* `gateway`: How devices are connected together in a logical structure to proxy information from
  legacy (non-UDMI) fieldbus protocols.
* `discovery`: Raw information from on-prem discovery about on-prem configuration and setup.
* cloud: How a device is represented or connects to cloud infrastructure (e.g. the authentication
  key type).
